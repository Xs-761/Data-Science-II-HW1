---
title: "Data Science II, HW1"
output: github_document
---

```{r packages, message=FALSE, warnig=FALSE}
  library(glmnet)
  library(caret)
  library(dplyr)
  library(tidymodels) # mata-engines for model training
  library(corrplot)   # to generate correlation matrix
  library(ggplot2)    # for plots and graphics
  library(plotmo)     # to generate trace plot 
  library(ggrepel)    # for plotting functions
```

```{r load data}
  train <- read.csv("../housing_training.csv") %>% na.omit() %>% relocate("Sale_Price","Overall_Qual","Kitchen_Qual","Fireplace_Qu","Exter_Qual")
  test <- read.csv("../housing_test.csv") %>% na.omit() %>% relocate("Sale_Price","Overall_Qual","Kitchen_Qual","Fireplace_Qu","Exter_Qual")
```

```{r}
  set.seed(21)
```

```{r Matrix of Predictors, fig.align='center', fig.width=10, fig.height=10}
  predictors = model.matrix(Sale_Price ~ ., train)[,-1]  # matrix of predictors, converted categorical to dummies
  response   = train[, "Sale_Price"]
  corrplot::corrplot(cor(predictors), method = "shade", type = "upper", tl.cex=.75, tl.col="black") # heatmap
```

```{r Common Lambda Grid}
  lambda_grid <- exp(seq(10,-5, length = 100))  # lambda sequence in DESC order
```

### Part A — Lasso Model

```{r Lasso Regression, fig.align='center'}
  cv.lasso = cv.glmnet(x=predictors, y=response, standardize=TRUE, alpha=1, lambda=lambda_grid)
  plot(cv.lasso)
  
  cv.lasso$lambda.min
  cv.lasso$lambda.1se
  
  plot_glmnet(cv.lasso$glmnet.fit)
  
  predict(cv.lasso, s="lambda.min", type="coefficients")
```

-   **Selected Tuning Parameter for Lasso** (optimal λ): 38

    -   **Corresponding Test MSE**: `r round(cv.lasso$lambda.min, 4)`

-   **#of Predictors associates with 1SE**: 36

### Part B — Elastic Net

```{r}
  TC = trainControl(method="cv", number=10)
  ENet.fit <- train( Sale_Price ~ ., 
                     data=train,
                     method="glmnet", 
                     tuneGrid= expand.grid(alpha=seq(0,1,length=20), lambda=lambda_grid),
                     trControl = TC
                    )
```

-   **Optimal Tuning Parameter given by:**
    -   α = `r round(ENet.fit$bestTune$alpha, 4)`
    -   λ = `r round(ENet.fit$bestTune$lambda, 4)`

### Part C

```{r}

```

### Part D

```{r}

```

### Part E
